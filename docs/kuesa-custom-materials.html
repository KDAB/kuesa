<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- kuesa-custom-materials.qdoc -->
  <title>Kuesa Custom Materials | Kuesa Runtime 1.2</title>
<link rel='stylesheet' href='style/bootstrap.min.css'> <link rel='stylesheet' href='style/dracula.css'> <link rel='stylesheet' href='style/style.css'><script type='text/javascript' src='scripts/jquery.slim.min.js'></script> <script type='text/javascript' src='scripts/bootstrap.bundle.min.js'></script> <script type='text/javascript' src='scripts/highlight.pack.js'></script> <script type='text/javascript' src='scripts/clipboard.min.js'></script> <script type='text/javascript' src='scripts/script.js'></script></head>
<div id="title"> <div class="logo"> <a href="https://www.kdab.com" target=”_blank” class="ui-link"> <img src="images/kdab-logo.png" alt="KDAB Logo"> </a> </div> <div class="header"> <h1>Kuesa Runtime</h1> </div> </div> <div id="breadcrumbs"><ul><li><a href="index.html">Kuesa Runtime 1.2</a></li>
<li><a href="kuesa-overview.html#kuesa-runtime">Kuesa Runtime</a></li>
<li>Kuesa Custom Materials</li>
<li id="buildversion"><a href="kuesa-overview.html#kuesa-runtime">Kuesa Runtime 1.2 Reference Documentation</a></li>
</ul></div><div class='doc-content'><div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#generating-material-classes">Generating Material Classes</a></li>
<li class="level1"><a href="#registering-new-material-classes">Registering new Material Classes</a></li>
<li class="level2"><a href="#registering-with-qml">Registering with QML</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Kuesa Custom Materials</h1>
<span class="subtitle"></span>
<!-- $$$kuesa-custom-materials.html-description -->
<div class="descr"> <a name="details"></a>
<p>Kuesa provides a mecanism to extend the type of materials available in glTF files. This mecanism relies on 2 parts:</p>
<ol class="1" type="1"><li>Generating C++ Classes for the custom Material</li>
<li>Registering the material classes against the glTF importer</li>
</ol>
<a name="generating-material-classes"></a>
<h2 id="generating-material-classes">Generating Material Classes</h2>
<p>The process of generating C++ Qt3D compatible material classes has been simplified in Kuesa through the use of a class generator.</p>
<p>This generator expects a JSON based description of the material. It expects you to define:</p>
<ul>
<li>The Name of the material</li>
<li>The Documentation of the material</li>
<li>A set of properties the material will expose to control its appearance</li>
<li>A list of shaders for various OpenGL versions, providing the shader code or the path to a shader graph. If both a code and a path are provided, the code has priority over the graph.</li>
</ul>
<pre class="cpp plain">

  {
      &quot;type&quot;: &quot;CustomPainting&quot;,
      &quot;doc&quot;: &quot;Description of what the material does&quot;
      &quot;properties&quot;: [
          { &quot;name&quot;: &quot;color&quot;, &quot;type&quot;: &quot;vec3&quot;, &quot;doc&quot;: &quot;Specifies the output color&quot; },
       ],
      &quot;shaders&quot;: [
          {
              &quot;format&quot;: { &quot;api&quot;: &quot;OpenGLES&quot;, &quot;major&quot;: 2, &quot;minor&quot;: 0 },
              &quot;type&quot;: &quot;Vertex&quot;,
              &quot;code&quot;: &quot;..&#x2e;&quot;
          },
          {
              &quot;format&quot;: { &quot;api&quot;: &quot;OpenGLES&quot;, &quot;major&quot;: 3, &quot;minor&quot;: 0 },
              &quot;type&quot;: &quot;Vertex&quot;,
              &quot;code&quot;: &quot;..&#x2e;&quot;
          },
          {
              &quot;format&quot;: { &quot;api&quot;: &quot;OpenGL&quot;, &quot;major&quot;: 3, &quot;minor&quot;: 2 },
              &quot;type&quot;: &quot;Vertex&quot;,
              &quot;graph&quot;: &quot;qrc:/..&#x2e;&quot;
          },
          {
              &quot;format&quot;: { &quot;api&quot;: &quot;OpenGLES&quot;, &quot;major&quot;: 2, &quot;minor&quot;: 0 },
              &quot;type&quot;: &quot;Fragment&quot;,
              &quot;code&quot;: &quot;..&#x2e;&quot;
          },
          {
              &quot;format&quot;: { &quot;api&quot;: &quot;OpenGLES&quot;, &quot;major&quot;: 3, &quot;minor&quot;: 0 },
              &quot;type&quot;: &quot;Fragment&quot;,
              &quot;code&quot;: &quot;..&#x2e;&quot;
          },
          {
              &quot;format&quot;: { &quot;api&quot;: &quot;OpenGL&quot;, &quot;major&quot;: 3, &quot;minor&quot;: 2 },
              &quot;type&quot;: &quot;Fragment&quot;,
              &quot;graph&quot;: &quot;qrc:/..&#x2e;&quot;
          }
      ]
  }

</pre>
<p>Once the description file has been created, the C++ classes can be generated by calling the script file custom_material_class_generator.py</p>
<pre class="cpp plain">

  custom_material_class_generator.py CustomPainting.json

</pre>
<p>This will generate a sub directory custompainting containing a .pri file. That .pri file should be included to the project's .pro to get the material classes built.</p>
<a name="registering-new-material-classes"></a>
<h2 id="registering-new-material-classes">Registering new Material Classes</h2>
<p>The second step to adding a new custom material to Kuesa is to register it with the glTF importer.</p>
<p>To do so, you'll have to call GLTF2Importer::registerCustomMaterial providing the material, properties and effect classes as well as the name of the glTF material it maps to.</p>
<pre class="cpp plain">

  #include &lt;Kuesa/GLTF2Importer&gt;

  ..&#x2e;

  GLTF2Importer::registerCustomMaterial&lt;CustomPaintingMaterial, CustomPaintingProperties, CustomPaintingEffect&gt;(QStringLiteral(&quot;CustomPainting&quot;));

</pre>
<p>Please note that this needs to be done prior to any importing.</p>
<a name="registering-with-qml"></a>
<h3 id="registering-with-qml">Registering with QML</h3>
<p>If you wish to be able to instantiate the Material classes on the QML side or access them by retrieving them from the load glTF tree, you'll also have to register the C++ classes using the usual qmlRegisterType function.</p>
</div>
<!-- @@@kuesa-custom-materials.html -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p class="text-center">
   <acronym title="Copyright">&copy;</acronym> 2020 KDAB.
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.<br/>    Kuesa and respective logos are trademarks of KDAB.     in Finland and/or other countries worldwide. All other trademarks are property
   of their respective owners. </p>
</div>
</body>
</html>
